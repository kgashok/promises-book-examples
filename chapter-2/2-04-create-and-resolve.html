<!DOCTYPE html>
<html>
<head>
<title>2-4. Creating and resolving a promise</title>
<link href="../prism.css" rel="stylesheet">
<script src="../prism.js"></script>

<script>
function execute() { 
  loadImage('https://bit.ly/killYouSoon').then(function (img) {
    console.log('received image');
    document.body.appendChild(img); 
      
  }).catch(function (e) {
    console.log('Error occurred while loading image');
    console.log(e);
  });

  function loadImage(url) {
    var promise = new Promise(
      function resolver(resolve, reject) {
        var img = new Image();
        img.src = url;

        img.onload = function () {
          resolve(img);
        };

        img.onerror = function (e) {
          reject(e);
        };
      }
    );
    return promise;
  }
}
</script>

</head>
<body>

<nav>
<a href="2-03-chaining-then-catch.html">Previous</a> | <a href="2-05-multiple-consumers.html">Next</a>
</nav>

<h1>Example 2-4. Creating and resolving a promise</h1>
<div>
<button id ="invoke" onclick="execute()">Submit! </button>
(view output in console - press Ctrl-Shift-i and look for image insertion below)   
</div>
  
<pre>
<code class="language-javascript">
  loadImage('https://bit.ly/killYouSoon').then(function (img) {
    console.log('received image');
  }).catch(function (e) {
    console.log('Error occurred while loading image');
    console.log(e);
  });
  
  function loadImage(url) {
	var promise = new Promise(
		function resolver(resolve, reject) {
			var img = new Image();
			img.src = url;
			
			img.onload = function () {
				resolve(img);
			};

			img.onerror = function (e) {
				reject(e);
			};
		}
	);
	return promise;
}
</code>
</pre>

</body>
</html>
