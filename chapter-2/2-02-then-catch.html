<!DOCTYPE html>
<html>
<head>
<title>2-2. Promise then and catch</title>
<link href="../prism.css" rel="stylesheet">
<script src="../prism.js"></script>

<script>
function execute() { 
  var url = 'https://j.mp/generalProblem';
  var promise = loadImage(url); // 'https://j.mp/generalProblem');


  promise.then(function (img) {
    console.log('received image');
    console.log(img);

    if (document.body !== null) 
      document.body.appendChild(img);
    else
      console.log ("DOM not yet loaded!"); 
  });

  promise.catch(function (e) {
    console.log('Error occurred while loading image');
    console.log(e);
  });

  // Additional code so example can run
  function loadImage(url) {
    return new Promise(function (resolve) {
      var img = new Image();
      img.src = url;
      resolve(img);
    });
  }
}
</script>

</head>
<body>

<nav>
<a href="2-01-using-callbacks.html">Previous</a> | <a href="2-03-chaining-then-catch.html">Next</a>
</nav>

<h1>Example 2-2. Promise then and catch</h1>
<div>
<button id ="invoke" onclick="execute()">Submit! </button>
(view output in console - press Ctrl-Shift-i and look for image insertion below)   
</div>
  
<pre>
<code class="language-javascript">
var url = 'https://j.mp/generalProblem';
var promise = loadImage(url); // 'https://j.mp/generalProblem');


promise.then(function (img) {
  console.log('received image');
  console.log(img);

  if (document.body !== null) 
    document.body.appendChild(img);
  else
    console.log ("DOM not yet loaded!"); 
});

promise.catch(function (e) {
  console.log('Error occurred while loading image');
  console.log(e);
});

// Additional code so example can run
function loadImage(url) {
  return new Promise(function (resolve) {
    var img = new Image();
    img.src = url;
    resolve(img);
  });
</code>
</pre>

</body>
</html>
